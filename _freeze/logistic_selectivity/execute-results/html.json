{
  "hash": "d0f9443f0375012fd5e34b81fcae14a5",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Standard Logistic Selectivity\"\nsubtitle: \"Two-parameter ascending logistic formulation\"\nformat:\n  html:\n    toc: true\n    number-sections: true\nexecute:\n  echo: false\n  message: false\n  warning: false\n---\n\n## Overview\n\nThe standard (ascending) logistic selectivity is the simplest and most commonly\nused parameterization in age-structured stock assessments. It assumes that\nselectivity increases monotonically with age and asymptotes at full selectivity.\n\n## Model definition\n\nWith parameters $a_{50}$ (age at 50% selectivity) and $\\delta$ (slope width from\n50% to 95% selectivity):\n\n$$\n\\text{sel}(a) = \\frac{1}{1 + \\exp\\left[-\\log(19)\\,\\frac{a - a_{50}}{\\delta}\\right]}\n$$\n\nwhere $\\delta > 0$ controls how quickly selectivity transitions from low to high\nvalues.\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(ggplot2)\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(tidyr)\nlibrary(patchwork)\n\nlogistic_sel <- function(age, a50, delta) {\n  1 / (1 + exp(-log(19) * (age - a50) / delta))\n}\n\nages <- seq(1, 15, by = 0.1)\n```\n:::\n\n\n## Scenario exploration\n\n\n::: {#cell-fig-logistic-scenarios .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-logistic-scenarios\n#| fig-cap: \"Standard logistic selectivity under different parameterizations.\"\nscenarios <- expand_grid(\n  a50 = c(3, 5, 7),\n  delta = c(0.5, 1.5, 3.0),\n  age = ages\n) %>%\n  mutate(\n    selectivity = logistic_sel(age, a50, delta),\n    label = sprintf(\"a50 = %g, delta = %g\", a50, delta)\n  )\n\nggplot(scenarios, aes(x = age, y = selectivity, color = factor(delta))) +\n  geom_line(linewidth = 1) +\n  facet_wrap(~ paste(\"a50 =\", a50)) +\n  geom_hline(yintercept = c(0.5, 0.95), linetype = \"dashed\",\n             color = \"gray50\", alpha = 0.7) +\n  scale_color_viridis_d(name = \"delta\") +\n  scale_y_continuous(limits = c(0, 1.05)) +\n  labs(x = \"Age\", y = \"Selectivity\") +\n  theme_bw(base_size = 11) +\n  theme(panel.grid.minor = element_blank())\n```\n\n::: {.cell-output-display}\n![Standard logistic selectivity under different parameterizations.](logistic_selectivity_files/figure-html/fig-logistic-scenarios-1.png){#fig-logistic-scenarios width=672}\n:::\n:::\n\n\n## RTMB implementation\n\n*Placeholder: RTMB objective function with priors on $a_{50}$ and $\\delta$,\noptimization, and MCMC sampling.*\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#| eval: false\n#| echo: true\nlibrary(RTMB)\n\n# Objective function skeleton\nf <- function(parms) {\n  getAll(data, parms, warn = FALSE)\n  a50 <- exp(log_a50)\n  delta <- exp(log_delta)\n  sel_hat <- logistic_sel(age, a50, delta)\n\n  nll <- 0\n  # Priors\n  nll <- nll - dnorm(log_a50, mu_log_a50, sd_log_a50, log = TRUE)\n  nll <- nll - dnorm(log_delta, mu_log_delta, sd_log_delta, log = TRUE)\n\n  ADREPORT(c(a50 = a50, delta = delta))\n  nll\n}\n```\n:::\n\n",
    "supporting": [
      "logistic_selectivity_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}